# defect-management

## Описание проекта
### Cоздать монолитное веб-приложение для централизованного управления дефектами на строительных объектах. 

## Функциональность

### Основные возможности
- **Аутентификация и авторизация**: JWT-токены, ролевая модель доступа.
- **Управление пользователями**: Регистрация, профили, роли (Лидер, Инженер, Менеджер).
- **Управление проектами**: Создание, редактирование, управление доступом пользователей к проектам.
- **Отслеживание дефектов**: Создание, редактирование, назначение исполнителей, изменение статусов и приоритетов.
- **Вложения и комментарии**: Прикрепление файлов к дефектам, обсуждение в комментариях.
- **История изменений**: Автоматическое логирование всех изменений дефектов.
- **Отчеты**: Генерация отчетов по дефектам в формате Excel.
- **Графики и аналитика**: Визуализация данных с помощью диаграмм.

- ### Роли пользователей
- **Руководитель**: Полный доступ ко всем функциям, включая управление пользователями и проектами.
- **Инженер**: Создание и редактирование дефектов в доступных проектах.
- **Менеджер**: Управление дефектами, назначение исполнителей, генерация отчетов.

Подробные диаграммы прецедентов и пользовательских историй доступны в [diagrams.md](./diagrams.md).


## Технологии

### Бэкенд
- **NodeJS**
- **SQlite**: База данных.
- **JWT**: Аутентификация и авторизация.
- **bcrypt**: Хеширование паролей.

### Фронтенд
- **React**: Библиотека для создания пользовательских интерфейсов.
- **Tailwind CSS**: CSS-фреймворк для стилизации.
- **Chart.js**: Библиотека для создания диаграмм.

### Дополнительно
- **ESLint и Prettier**: Линтинг и форматирование кода.

## Инструкция
1. Скачать архив с кодом, распаковать, занести в среду visual studio code.
2. В терминале написать npm install
3. После установки пакетов написать npm run dev. Проект забилдится сразу весь: и серверная часть, и клиентская.
5. Зайти в браузер и перейти по http://localhost:8080/login

## Пользовательская документация

### Вход в систему
1. Откройте приложение в браузере - http://localhost:8080/login.
2. Введите логин и пароль.

### Работа с проектами
- **Менеджер**: Создает проекты, управляет доступом пользователей.
- **Инженер/Наблюдатель**: Просматривает доступные проекты.

### Работа с дефектами
- **Создание дефекта**: Инженер может создать дефект в доступном проекте и меняет статусы дефектов.
- **Редактирование**: Менеджер назначает исполнителей, меняет статусы.
- **Вложения**: Прикрепляйте файлы к дефектам.
- **Комментарии**: Обсуждайте дефекты в комментариях.

### Отчеты
- Менеджер и инженер может генерировать отчеты по дефектам в формате Excel.

## Обучение

### Для новых пользователей
1. **Регистрация**: Введите логин и пароль для регистрации и выберите свою роль.
2. **Знакомство с интерфейсом**: Изучите навигацию и основные разделы.
3. **Тренировка**: Создайте тестовый проект и дефект.

### Руководство для Инженера
1. Войдите в систему.
2. Выберите проект.
3. Создайте дефект с описанием проблемы.
4. Прикрепите необходимые файлы.
5. Генерируйте отчеты для руководства.

### Руководство для Менеджера
1. Просмотрите дефекты в проектах.
2. Назначьте исполнителей.
3. Измените статусы по мере решения.
4. Генерируйте отчеты для руководства.

## Структура тестов

- `simple_test.py` - 10 unit тестов для утилит и вспомогательных функций
- `simple_integration_test.py` - 5 интеграционных тестов для API endpoints
- `run_all_tests.py` - скрипт для запуска всех тестов
- `conftest.py` - конфигурация pytest и фикстуры (для расширенных тестов)
- `pytest.ini` - настройки pytest
- `run_tests.py` - скрипт для запуска тестов с pytest

## Установка зависимостей для тестов

```bash
pip install -r requirements.txt
```

## Запуск тестов

### Все тесты (рекомендуется)
```bash
python3 tests/run_all_tests.py
```

### Только unit тесты
```bash
python3 tests/simple_test.py
```

### Только интеграционные тесты
```bash
python3 tests/simple_integration_test.py
```

### Через pytest (требует установки зависимостей)
```bash
pip install -r requirements.txt
pytest tests/ -v
```

## Описание тестов

### Unit тесты (10 тестов)
1. **test_unit_date_utils** - тест утилит для работы с датами
2. **test_unit_id_generation** - тест генерации уникальных ID
3. **test_unit_csv_escaping** - тест экранирования CSV данных
4. **test_unit_priority_validation** - тест валидации приоритетов
5. **test_unit_status_validation** - тест валидации статусов
6. **test_unit_email_validation** - тест валидации email адресов
7. **test_unit_password_validation** - тест валидации паролей
8. **test_unit_role_validation** - тест валидации ролей пользователей
9. **test_unit_json_parsing** - тест парсинга JSON данных
10. **test_unit_string_utilities** - тест строковых утилит

### Интеграционные тесты (5 тестов)
1. **test_integration_user_registration_and_login** - тест регистрации и входа пользователей
2. **test_integration_defect_crud_operations** - тест CRUD операций с дефектами
3. **test_integration_defect_filtering_and_pagination** - тест фильтрации и пагинации
4. **test_integration_projects_and_statistics** - тест получения проектов и статистики
5. **test_integration_authentication_and_authorization** - тест аутентификации и авторизации

### Регистрация/Авторизация

<img width="1461" height="709" alt="image" src="https://github.com/user-attachments/assets/a67b4b38-04ad-41fb-b5ad-7e8a1227daf0" />
<img width="1457" height="706" alt="image" src="https://github.com/user-attachments/assets/7f79cda3-9dc1-4766-a601-54a0d165323d" />

### Главная страница

<img width="1461" height="719" alt="image" src="https://github.com/user-attachments/assets/eb75a567-e390-45e9-9a4d-82e242f951f8" />

### Статистика

<img width="1459" height="713" alt="image" src="https://github.com/user-attachments/assets/554f2b5c-c849-4c78-9687-92590344c6dc" />

### Страница дефекта

<img width="1469" height="715" alt="image" src="https://github.com/user-attachments/assets/c488c57e-5dac-40db-b3c2-d407fcfb91d1" />

### Создание/редактирование/удаление дефекта

<img width="1462" height="716" alt="image" src="https://github.com/user-attachments/assets/f183d95d-ec0e-4bfc-9af0-12b3ee49a1f3" />
<img width="1460" height="718" alt="image" src="https://github.com/user-attachments/assets/fa587e1f-94e0-40f0-acb6-fe1129b6ae47" />
<img width="1462" height="714" alt="image" src="https://github.com/user-attachments/assets/820452f3-5b91-4ab2-862a-90ca78e5cd23" />

### Изменение статуса и сохранение комментариев

<img width="1455" height="712" alt="image" src="https://github.com/user-attachments/assets/ca153fff-8a0c-4fea-b072-4cb92659c50e" />

### Инженер не может делать отчет и удалять дефекты

<img width="1463" height="715" alt="image" src="https://github.com/user-attachments/assets/b0ecacfb-b3da-45fd-b828-fb6d6b5b6c95" />

### Руководитель и заказчик (наблюдатель) могут только смотреть статистику и смотреть прогремм дефекта

<img width="1461" height="723" alt="image" src="https://github.com/user-attachments/assets/58d5e919-e263-4882-aa89-3ebfcb31fc23" />
<img width="1462" height="718" alt="image" src="https://github.com/user-attachments/assets/4216659f-e8c3-4848-96f0-ae736c08dfee" />












